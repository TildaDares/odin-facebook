<% content_for(:title, 'Home') %>

<%= render 'nav' %>
<div class="d-flex justify-content-between">
  <div class="shadow-sm col-lg-3 pl-4 pt-4 dis-none" style="height:85vh; position:sticky; top:64px;"> 
    <div>
      <%= link_to current_user, class: "text-decoration-none" do %>
        <%= image_tag(current_user.avatar_thumbnail, :class => "rounded-circle mr-2", size: "35x35", alt: "Profile pic") %>
        <span class="text-dark" style="font-size:1.2rem"><%= current_user.username %></span><br/>
      <% end %>
    </div>

    <div class="mt-4">
      <%= link_to current_user, class: "text-decoration-none" do %>
        <i class="fas fa-user-friends fa-2x mr-2"></i>
        <span class="text-dark" style="font-size:1.2rem">Friends</span><br/>
      <% end %>
    </div>

    <div class="mt-4">
      <%= link_to current_user, class: "text-decoration-none" do %>
        <i class="fas fa-user-cog fa-2x mr-2"></i>
        <span class="text-dark" style="font-size:1.2rem">Settings</span><br/>
      <% end %>
    </div>

    <div class="mt-4">
      <%= link_to current_user, class: "text-decoration-none" do %>
        <i class="fas fa-heart fa-2x text-color mr-2"></i>
        <span class="text-dark" style="font-size:1.2rem">Likes</span><br/>
      <% end %>
    </div>
  </div>

  <div class="container col-lg-6">
    <ul class="nav nav-pills mb-3 pt-2 pb-2 d-flex justify-content-around shadow-sm w-100 bg-white" id="pills-tab" role="tablist" style="position:sticky; top:64px; z-index:1000">
      <li class="nav-item" role="presentation">
        <a class="nav-link active" id="pills-home-tab" data-toggle="pill tooltip" title="Home" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true"><i class="fas fa-home"></i></a>
      </li>
      <li class="nav-item" role="presentation">
        <a class="nav-link" id="pills-profile-tab" data-toggle="pill tooltip" title="Users" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false"><i class="fas fa-users"></i></a>
      </li>
      <li class="nav-item" role="presentation">
        <a class="nav-link" id="pills-contact-tab" data-toggle="pill tooltip" title="Friends" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false"><i class="fas fa-user-friends"></i></a>
      </li>
      <li class="nav-item" role="presentation">
        <a class="nav-link" id="pills-contact-tab" data-toggle="pill tooltip" title="Search" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false"><i class="fas fa-search"></i></a>
      </li>
      <li class="nav-item" role="presentation">
        <a class="nav-link" id="pills-contact-tab" data-toggle="pill tooltip" title="Profile" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false">
          <%= link_to current_user, class: "text-decoration-none" do %>
            <%= image_tag(current_user.avatar_thumbnail, :class => "rounded-circle mr-2", size: "20x20", alt: "Profile pic") %>
          <% end %>
        </a>
      </li>
    </ul>

    <div class="tab-content" id="pills-tabContent">
      <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
        <% @posts.each do |post| %>
          <div class="shadow-sm pt-3 pl-4 pr-4 pb-3 mt-3">
            <div class="d-flex justify-content-between">
              <div>
                <div>
                  <%= link_to post.user, class: "text-decoration-none" do %>
                    <%= image_tag(post.user.avatar_thumbnail, :class => "rounded-circle mr-2", size: "25x25", alt: "Profile pic") %>
                  <% end %>
                  <strong><span style="font-size:0.9rem"><%= post.user.username %></span></strong><br/>
                </div>
                <div>
                  <small class="text-muted ml-3 pl-4" style="font-size:0.7rem"><%= distance_of_time_in_words(Time.now, post.created_at, scope: 'datetime.distance_in_words.short', include_seconds: true) %>.</small>
                </div>
              </div>
              <div class="dropleft btn-group">
                <button class="btn" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <% if post.user == current_user %>
                    <i class="fas fa-chevron-down text-muted"></i>
                  <% end %>
                </button>
                <div class="dropdown-menu">
                  <%= link_to "Delete post", post_path(post), method: :delete, data: { confirm: "Are you sure you want to delete this post?" }, class: "dropdown-item" %>
                </div>
              </div>
            </div>

            <%= link_to post, class: "text-decoration-none text-dark" do %>
              <div class="mt-2">
                <% if post.body.to_plain_text.length > 500 %>
                  <div style="line-height: 1.9"><%= truncate(post.body.to_plain_text, length: 500) %></div>
                  <%= link_to 'read more', post %>
                <% else %>
                  <%= post.body %>
                <% end %>
              </div>
            <% end %>
            <div class="d-flex justify-content-around mt-5">
              <i class="far fa-heart text-muted"></i>
              <i class="far fa-comment text-muted"></i>
              <div class="social-likes social-likes_single" data-counters="no" data-url="https://sheltered-lowlands-27506.herokuapp.com/posts/<%= post.id %>" data-title="Check out my post" data-single-title="">Share
                <div class="facebook" title="Share link on Facebook">Facebook</div>
                <div class="twitter" data-via="B_eautifulChaos" title="Share link on Twitter">Twitter</div>
                <div class="pinterest" title="Share image on Pinterest" data-media="https://unsplash.com/photos/4wz1YsANFB0">Pinterest</div>
              </div>
            </div>
          </div>
          <% unless @posts.last == post %>
            <hr class="solid">
          <% end %>
        <% end %>

        <div class="d-flex justify-content-end">
          <div class="circle d-flex justify-content-center align-items-center bg-color mr-4">
            <%= link_to new_post_path do %>
              <i class="fas fa-plus text-white" style="font-size: 1.6rem"></i>
            <% end %>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">...</div>
    <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">...</div>
  </div>

  <div class="shadow-sm col-lg-3 pl-4 dis-none" style="height:85vh; position:sticky; top:64px;">
    <h3 class="text-color mt-3 mb-3">Suggested</h3>
    <hr class="solid">
    <% @users.each do |user| %>
      <div class="d-flex justify-content-between mb-3">
        <p><%= user.username %></p>
        <p><p>
        <%= link_to "Add Friend", root_path, class: "btn btn-outline-danger shadow" %><br/>
      </div>
    <% end %>
  </div>
</div>
<%= button_to "logout", destroy_user_session_path, method: :delete %>